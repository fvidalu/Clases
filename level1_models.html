<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Códice II: Modelos Clásicos y Memoria [Edición Definitiva] - El Códice de la IA</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=Google+Sans:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <style>
        :root {
            --blue-100: #e8f0fe; --blue-500: #1a73e8; --blue-700: #174ea6;
            --red-100: #fce8e6; --red-500: #ea4335; --red-700: #c5221f;
            --yellow-100: #fef7e0; --yellow-500: #fbbc04; --yellow-700: #f29900;
            --green-100: #e6f4ea; --green-500: #34a853; --green-700: #1e8e3e;
            --purple-100: #f3e8fd; --purple-500: #9333ea; --purple-700: #6b21a8;
            --gray-900: #202124; --gray-800: #3c4043; --gray-700: #5f6368; --gray-200: #e8eaed; --gray-100: #f1f3f4; --gray-50: #f8f9fa;
            --bg-color: #fff; --text-color: var(--gray-800);
        }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes draw-line { from { stroke-dashoffset: 1000; } to { stroke-dashoffset: 0; } }

        body { font-family: 'Inter', sans-serif; background-color: var(--bg-color); color: var(--text-color); line-height: 1.75; }
        h1, h2, h3, h4, h5, h6 { font-family: 'Google Sans', sans-serif; color: var(--gray-900); letter-spacing: -0.02em; }
        .content-section { animation: fadeIn 0.8s ease-out forwards; border-bottom: 1px solid var(--gray-200); padding-bottom: 4rem; margin-bottom: 4rem; }
        .content-section:last-child { border-bottom: none; }
        .concept-box { background-color: var(--gray-50); border: 1px solid var(--gray-200); border-left: 4px solid var(--blue-500); padding: 24px; border-radius: 8px; margin: 2rem 0; }
        .deep-dive-box { background-color: var(--yellow-100); border: 1px solid var(--yellow-500); border-left: 4px solid var(--yellow-700); padding: 24px; border-radius: 8px; margin: 2rem 0; }
        .business-case-box { background-color: var(--green-100); border: 1px solid var(--green-500); border-left: 4px solid var(--green-700); padding: 24px; border-radius: 8px; margin: 2rem 0; }
        .visualization { background: linear-gradient(145deg, #ffffff, #f7f8fa); border: 1px solid var(--gray-200); border-radius: 12px; padding: 2rem; margin: 2rem 0; box-shadow: 0 4px 6px rgba(0,0,0,0.05); overflow: hidden; }
        .visualization > svg,
        .visualization > img,
        .visualization > iframe {
            width: 100%;
            height: auto;
            max-width: 800px;
            display: block;
            margin-left: auto;
            margin-right: auto;
        }
        .code-block { background-color: #202124; color: #e8eaed; border-radius: 8px; padding: 16px; margin: 1rem 0; overflow-x: auto; font-family: 'Roboto Mono', monospace; font-size: 0.9em; }
        .formula-box { background-color: var(--blue-100); border: 1px solid var(--blue-500); color: var(--gray-900); padding: 1.5rem; margin: 1rem 0; border-radius: 8px; text-align: center; font-family: 'Roboto Mono', monospace; font-size: 1.1em; }
        .wow-animation-card { background: radial-gradient(circle, rgba(26,115,232,0.1) 0%, rgba(255,255,255,0) 70%); border: 1px solid var(--blue-200); }
    </style>
</head>
<body class="antialiased">

    <header class="bg-white/80 backdrop-blur-sm shadow-sm sticky top-0 left-0 right-0 z-50">
        <nav class="container mx-auto px-6 py-4 flex justify-between items-center">
            <a href="index.html" class="text-2xl font-bold font-googlesans text-gray-800 hover:text-blue-500 transition-colors">El Códice de la IA</a>
            <a href="index.html#chapters" class="text-blue-500 hover:underline font-medium">Volver a los Códices</a>
        </nav>
    </header>

    <main class="container mx-auto px-6 py-12 pt-24">

        <div class="max-w-4xl mx-auto">
            <h1 class="text-4xl md:text-5xl font-bold tracking-tighter mb-4">Códice II: Modelos Clásicos y Memoria</h1>
            <p class="text-xl text-gray-600 mb-12">El amanecer de la memoria secuencial. Un análisis exhaustivo de las arquitecturas RNN, LSTM y GRU, sus mecanismos internos y sus aplicaciones en el mundo real.</p>

            <section class="content-section">
                <h2 class="text-3xl font-bold mb-6">Objetivos del Códice II</h2>
                <ul class="list-disc list-inside ml-4 space-y-1">
                    <li>Comprender por qué las secuencias requieren memoria.</li>
                    <li>Dominar la arquitectura de RNN, LSTM y GRU.</li>
                    <li>Aplicar estos modelos a tareas como clasificación y NER.</li>
                </ul>
                <p class="mt-4">La metodología combina diagramas animados con ejemplos de código ejecutados durante las sesiones.</p>
            </section>

            <!-- Section 1: The Need for Memory -->
            <section class="content-section">
                <h2 class="text-3xl font-bold mb-6">1. ¿Por qué la Memoria es Crucial?</h2>
                <p class="mb-4">En el Códice I, aprendimos a convertir palabras en vectores. Pero los modelos como Bag-of-Words tienen una amnesia fundamental: ignoran el orden de las palabras. Para un modelo BoW, las siguientes dos frases son idénticas, aunque su significado es opuesto.</p>
                <div class="visualization">
                    <h4 class="text-xl font-bold text-center mb-4">El Orden Importa</h4>
                    <div class="grid md:grid-cols-2 gap-8 text-center">
                        <div class="p-4 border rounded-lg">
                            <p class="text-lg">"El perro persigue al gato"</p>
                        </div>
                        <div class="p-4 border rounded-lg">
                            <p class="text-lg">"El gato persigue al perro"</p>
                        </div>
                    </div>
                    <div class="text-center my-4">
                        <svg height="40" width="100%" viewBox="0 0 400 40"><path d="M 100 20 L 300 20" stroke="#EA4335" stroke-width="3" stroke-dasharray="5,5"/><text x="200" y="15" text-anchor="middle" font-family="Google Sans">Visto por Bag-of-Words</text></svg>
                    </div>
                    <div class="p-4 bg-gray-100 rounded-lg text-center font-mono">[perro:2, gato:2, el:2, persigue:2]</div>
                    <p class="text-center mt-4 text-red-600 font-semibold">¡El modelo no ve ninguna diferencia! Para entender el lenguaje, necesitamos procesarlo secuencialmente.</p>
                </div>
            </section>
            <!-- Section 1.5: Modelos Estadísticos -->
            <section class="content-section">
                <h2 class="text-3xl font-bold mb-6">1.5 N-gramas y HMMs</h2>
                <p class="mb-4">Antes de las redes neuronales, los modelos de <strong>n-gramas</strong> y los <strong>Modelos Ocultos de Márkov (HMM)</strong> nos permitieron captar dependencias cortas en el lenguaje. Aunque simples, siguen siendo herramientas didácticas para comprender secuencias.</p>
                <div class="visualization">
                    <svg width="100%" height="120" viewBox="0 0 400 120">
                        <style>.state{font-family: "Google Sans", sans-serif; font-weight: bold; text-anchor: middle;}</style>
                        <circle cx="100" cy="60" r="30" fill="#E8F0FE" stroke="#1A73E8"/>
                        <text x="100" y="65" class="state">S</text>
                        <circle cx="200" cy="60" r="30" fill="#E6F4EA" stroke="#34A853"/>
                        <text x="200" y="65" class="state">V</text>
                        <circle cx="300" cy="60" r="30" fill="#FEF7E0" stroke="#FBBC04"/>
                        <text x="300" y="65" class="state">O</text>
                        <path d="M130 60 L170 60" stroke="#5f6368" marker-end="url(#arrow-flow)"/>
                        <path d="M230 60 L270 60" stroke="#5f6368" marker-end="url(#arrow-flow)"/>
                    </svg>
                    <p class="text-center text-sm mt-2">Un esquema simple de HMM para oraciones Sujeto-Verbo-Objeto.</p>
                </div>
            </section>

            <!-- Section 2: RNNs -->
            <section class="content-section">
                <h2 class="text-3xl font-bold mb-6">2. Redes Neuronales Recurrentes (RNN)</h2>
                <p class="mb-4">Las RNN son el primer tipo de red neuronal diseñada para manejar datos secuenciales. Su innovación clave es un <strong>bucle</strong>. La red procesa una palabra, y la salida de ese paso se reintroduce como entrada para el siguiente. Así, la información "fluye" a través de la secuencia.</p>
                <div class="visualization">
                    <h4 class="text-xl font-bold text-center mb-4">Anatomía de una Celda RNN</h4>
                    <svg width="100%" height="auto" viewBox="0 0 400 300">
                        <style>.label{font-family: 'Google Sans', sans-serif; font-weight: bold; text-anchor: middle;} .token{font-family: 'Roboto Mono', sans-serif; text-anchor: middle;}</style>
                        <rect x="100" y="100" width="200" height="100" rx="10" fill="#F1F3F4" stroke="#DADCE0"/>
                        <text x="200" y="155" class="label">Celda RNN</text>
                        <text x="50" y="50" class="token">h(t-1)</text>
                        <path d="M 50 60 H 100" stroke="#FBBC04" stroke-width="2" marker-end="url(#arrow-flow)"/>
                        <text x="200" y="50" class="token">x(t)</text>
                        <path d="M 200 60 V 100" stroke="#34A853" stroke-width="2" marker-end="url(#arrow-flow)"/>
                        <text x="350" y="50" class="token">h(t)</text>
                        <path d="M 300 150 H 350" stroke="#FBBC04" stroke-width="2" marker-end="url(#arrow-flow)"/>
                        <text x="200" y="250" class="token">y(t)</text>
                        <path d="M 200 200 V 240" stroke="#EA4335" stroke-width="2" marker-end="url(#arrow-flow)"/>
                    </svg>
                    <p class="text-center text-sm mt-2">La celda RNN combina la entrada actual (x(t)) con el estado oculto anterior (h(t-1)) para producir un nuevo estado oculto (h(t)) y una salida (y(t)).</p>
                </div>
                
                <h3 class="text-2xl font-bold mt-8 mb-4">Animación Detallada de una RNN Desenrrollada</h3>
                <p class="mb-4">Para entender cómo una RNN procesa una secuencia, podemos "desenrrollarla" en el tiempo. Cada paso de tiempo representa una copia de la misma red neuronal, procesando una palabra de la secuencia y pasando un "estado oculto" (su memoria) al siguiente paso.</p>
                <div class="visualization">
                    <svg width="100%" height="auto" viewBox="0 0 800 350">
                        <style>.label{font-family: 'Google Sans', sans-serif; font-weight: bold; text-anchor: middle;} .token{font-family: 'Roboto Mono', sans-serif; text-anchor: middle; font-size: 16px;} .state-label{font-family: 'Roboto', sans-serif; font-size: 12px; text-anchor: middle;}</style>
                        <defs><marker id="arrow-flow" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse"><path d="M 0 0 L 10 5 L 0 10 z" fill="#5f6368"/></marker></defs>
                        <!-- Timestep 1 -->
                        <g id="step-1">
                            <rect x="50" y="100" width="100" height="80" rx="10" fill="#F1F3F4"/>
                            <text x="100" y="140" class="label">RNN</text>
                            <text x="100" y="70" class="token">"El"</text>
                            <path d="M 100 100 v -20" stroke="#34A853" stroke-width="2" marker-end="url(#arrow-flow)"/>
                            <text x="100" y="200" class="state-label">h₀</text>
                        </g>
                        <!-- Timestep 2 -->
                        <g id="step-2">
                            <rect x="250" y="100" width="100" height="80" rx="10" fill="#F1F3F4"/>
                            <text x="300" y="140" class="label">RNN</text>
                            <text x="300" y="70" class="token">"gato"</text>
                            <path d="M 300 100 v -20" stroke="#34A853" stroke-width="2" marker-end="url(#arrow-flow)"/>
                            <text x="300" y="200" class="state-label">h₁</text>
                        </g>
                        <!-- Timestep 3 -->
                        <g id="step-3">
                            <rect x="450" y="100" width="100" height="80" rx="10" fill="#F1F3F4"/>
                            <text x="500" y="140" class="label">RNN</text>
                            <text x="500" y="70" class="token">"negro"</text>
                            <path d="M 500 100 v -20" stroke="#34A853" stroke-width="2" marker-end="url(#arrow-flow)"/>
                            <text x="500" y="200" class="state-label">h₂</text>
                        </g>
                        <!-- Timestep 4 -->
                        <g id="step-4">
                            <rect x="650" y="100" width="100" height="80" rx="10" fill="#F1F3F4"/>
                            <text x="700" y="140" class="label">RNN</text>
                            <text x="700" y="70" class="token">"es"</text>
                            <path d="M 700 100 v -20" stroke="#34A853" stroke-width="2" marker-end="url(#arrow-flow)"/>
                            <text x="700" y="200" class="state-label">h₃</text>
                        </g>

                        <!-- Hidden State Flow -->
                        <path d="M 150 140 H 250" stroke="#FBBC04" stroke-width="3" marker-end="url(#arrow-flow)"/>
                        <path d="M 350 140 H 450" stroke="#FBBC04" stroke-width="3" marker-end="url(#arrow-flow)"/>
                        <path d="M 550 140 H 650" stroke="#FBBC04" stroke-width="3" marker-end="url(#arrow-flow)"/>

                        <!-- Animation -->
                        <circle cx="100" cy="140" r="15" fill="#E8F0FE">
                            <animate attributeName="cx" values="100; 300; 500; 700" dur="8s" repeatCount="indefinite" />
                            <animate attributeName="fill" values="#E8F0FE; #FEF7E0; #FCE8E6; #E6F4EA" dur="8s" repeatCount="indefinite" />
                        </circle>
                        <text x="400" y="280" text-anchor="middle" font-family="Google Sans" font-size="18px">Secuencia de Entrada: "El gato negro es..."</text>
                        <text x="400" y="310" text-anchor="middle" font-family="Google Sans" font-size="18px" font-weight="bold">Estado Oculto (Memoria de la Secuencia)</text>
                    </svg>
                </div>

                <div class="visualization mt-8">
                    <h4 class="text-xl font-bold text-center mb-4">Generación de Texto Paso a Paso con RNN/LSTM</h4>
                    <p class="text-center text-sm mb-4">Observa cómo el modelo predice la siguiente palabra basándose en el contexto generado hasta el momento.</p>
                    <div class="flex flex-col items-center">
                        <div class="w-full max-w-2xl bg-gray-100 p-4 rounded-lg border border-gray-200">
                            <p class="font-semibold mb-2">Semilla de texto: <span id="seed-text">El</span></p>
                            <p class="font-semibold mb-2">Texto generado: <span id="generated-text" class="text-blue-700"></span></p>
                            <button id="generate-button" class="mt-4 btn-primary">Generar Siguiente Palabra</button>
                        </div>
                        <script>
                            const vocabulary = ["gato", "perro", "corre", "juega", "duerme", "en", "la", "casa", "el", "un"];
                            const model = {
                                "El": ["gato", "perro"],
                                "gato": ["corre", "duerme"],
                                "perro": ["juega", "corre"],
                                "corre": ["en"],
                                "juega": ["en"],
                                "duerme": ["en"],
                                "en": ["la"],
                                "la": ["casa"],
                                "casa": ["."],
                                ".": []
                            };

                            let currentText = "El";

                            document.getElementById('generate-button').addEventListener('click', () => {
                                const lastWord = currentText.split(' ').pop();
                                const possibleNextWords = model[lastWord];

                                if (possibleNextWords && possibleNextWords.length > 0) {
                                    const nextWord = possibleNextWords[Math.floor(Math.random() * possibleNextWords.length)];
                                    currentText += " " + nextWord;
                                    document.getElementById('generated-text').innerText = currentText.substring(3);
                                } else {
                                    document.getElementById('generated-text').innerText += " (Fin de la secuencia)";
                                    document.getElementById('generate-button').disabled = true;
                                }
                            });

                            document.getElementById('generated-text').innerText = currentText.substring(3);
                        </script>
                    </div>
                </div>

                <h3 class="text-2xl font-bold mt-12 mb-4">El Talón de Aquiles: El Gradiente Desvanecido y Explosivo</h3>
                <p>Las RNN simples tienen un gran problema: su memoria es corta. Al entrenar, la señal de error (el gradiente) debe propagarse hacia atrás a través de todos los pasos. En secuencias largas, esta señal se multiplica por la misma matriz de pesos una y otra vez. Si los valores en la matriz son pequeños, la señal se diluye hasta desaparecer (<strong>gradiente desvanecido</strong>). Si son grandes, explota (<strong>gradiente explosivo</strong>). Esto impide que la red aprenda dependencias a largo plazo y hace que el entrenamiento sea inestable.</p>
                <div class="visualization">
                    <h4 class="text-xl font-bold text-center mb-4">Animación del Gradiente Desvanecido</h4>
                    <svg width="100%" height="auto" viewBox="0 0 800 200">
                        <style>.label{font-family: 'Google Sans', sans-serif; font-weight: bold; text-anchor: middle;}</style>
                        <text x="400" y="30" class="label">Propagación del Error Hacia Atrás en el Tiempo</text>
                        <!-- RNN Cells -->
                        <g><rect x="650" y="80" width="100" height="60" rx="5" fill="#F1F3F4"/><text x="700" y="115" class="label">t</text></g>
                        <g><rect x="450" y="80" width="100" height="60" rx="5" fill="#F1F3F4"/><text x="500" y="115" class="label">t-1</text></g>
                        <g><rect x="250" y="80" width="100" height="60" rx="5" fill="#F1F3F4"/><text x="300" y="115" class="label">t-2</text></g>
                        <g><rect x="50" y="80" width="100" height="60" rx="5" fill="#F1F3F4"/><text x="100" y="115" class="label">t-3</text></g>
                        <!-- Gradient Arrow -->
                        <path d="M 650 110 H 150" stroke="#EA4335" marker-start="url(#arrow-flow)">
                            <animate attributeName="stroke-width" values="10; 8; 5; 2; 1; 10" dur="8s" repeatCount="indefinite" />
                        </path>
                        <text x="400" y="170" class="label" fill="#C5221F">La señal de error se desvanece y no llega a los primeros pasos</text>
                    </svg>
                </div>
                <div class="visualization mt-8">
                    <h4 class="text-xl font-bold text-center mb-4">Animación del Gradiente Explosivo</h4>
                    <svg width="100%" height="auto" viewBox="0 0 800 200">
                        <style>.label{font-family: 'Google Sans', sans-serif; font-weight: bold; text-anchor: middle;}</style>
                        <text x="400" y="30" class="label">Propagación del Error Hacia Atrás en el Tiempo</text>
                        <!-- RNN Cells -->
                        <g><rect x="650" y="80" width="100" height="60" rx="5" fill="#F1F3F4"/><text x="700" y="115" class="label">t</text></g>
                        <g><rect x="450" y="80" width="100" height="60" rx="5" fill="#F1F3F4"/><text x="500" y="115" class="label">t-1</text></g>
                        <g><rect x="250" y="80" width="100" height="60" rx="5" fill="#F1F3F4"/><text x="300" y="115" class="label">t-2</text></g>
                        <g><rect x="50" y="80" width="100" height="60" rx="5" fill="#F1F3F4"/><text x="100" y="115" class="label">t-3</text></g>
                        <!-- Gradient Arrow -->
                        <path d="M 650 110 H 150" stroke="#1A73E8" marker-start="url(#arrow-flow)">
                            <animate attributeName="stroke-width" values="1; 2; 5; 8; 10; 1" dur="8s" repeatCount="indefinite" />
                        </path>
                        <text x="400" y="170" class="label" fill="#1A73E8">La señal de error crece exponencialmente, desestabilizando el entrenamiento</text>
                    </svg>
                </div>
                <div class="deep-dive-box">
                    <h4 class="text-lg font-semibold mb-2 text-dark">Teacher Forcing: Guiando el Aprendizaje</h4>
                    <p>Durante el entrenamiento de RNNs para generación de texto, en lugar de alimentar la propia salida del modelo en el siguiente paso (lo que podría propagar errores), a menudo usamos una técnica llamada <strong>Teacher Forcing</strong>. Consiste en alimentar la palabra correcta de la secuencia de entrenamiento como entrada en cada paso, independientemente de lo que el modelo haya predicho. Esto estabiliza el entrenamiento y acelera la convergencia, aunque puede crear una discrepancia entre cómo se entrena el modelo y cómo se usa en la inferencia.</p>
                </div>

                <div class="visualization mt-8">
                    <h4 class="text-xl font-bold text-center mb-4">Simulación Interactiva del Gradiente Desvanecido</h4>
                    <p class="text-center text-sm mb-4">Observa cómo un valor inicial disminuye rápidamente al multiplicarse repetidamente por un número pequeño (simulando un gradiente desvanecido).</p>
                    <div class="flex flex-col items-center">
                        <div class="w-full max-w-2xl bg-gray-100 p-4 rounded-lg border border-gray-200">
                            <div class="mb-4">
                                <label for="initial-value" class="block text-sm font-medium text-gray-700">Valor Inicial:</label>
                                <input type="number" id="initial-value" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2" value="100" step="10">
                            </div>
                            <div class="mb-4">
                                <label for="multiplier" class="block text-sm font-medium text-gray-700">Multiplicador (entre 0 y 1):</label>
                                <input type="number" id="multiplier" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2" value="0.8" step="0.1" min="0" max="1">
                            </div>
                            <div class="mb-4">
                                <label for="steps" class="block text-sm font-medium text-gray-700">Número de Pasos:</label>
                                <input type="number" id="steps" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2" value="10" step="1" min="1" max="20">
                            </div>
                            <button id="simulate-gradient" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">Simular</button>
                            <div class="mt-4">
                                <p class="font-semibold">Resultados:</p>
                                <div id="gradient-results" class="mt-2 p-3 bg-white rounded-md border border-gray-200 font-mono text-sm overflow-x-auto"></div>
                            </div>
                        </div>
                        <script>
                            function simulateGradient() {
                                let value = parseFloat(document.getElementById('initial-value').value);
                                const multiplier = parseFloat(document.getElementById('multiplier').value);
                                const steps = parseInt(document.getElementById('steps').value);
                                let resultsHtml = '';

                                for (let i = 0; i < steps; i++) {
                                    resultsHtml += `Paso ${i + 1}: ${value.toFixed(4)} * ${multiplier.toFixed(1)} = ${(value * multiplier).toFixed(4)}<br>`;
                                    value *= multiplier;
                                }
                                document.getElementById('gradient-results').innerHTML = resultsHtml;
                            }

                            document.getElementById('simulate-gradient').addEventListener('click', simulateGradient);
                            document.getElementById('initial-value').addEventListener('input', simulateGradient);
                            document.getElementById('multiplier').addEventListener('input', simulateGradient);
                            document.getElementById('steps').addEventListener('input', simulateGradient);
                            simulateGradient(); // Initial calculation
                        </script>
                    </div>
                </div>
            </section>

            <!-- Section 3: LSTMs -->
            <section class="content-section">
                <h2 class="text-3xl font-bold mb-6">3. LSTM: La Revolución de las Compuertas</h2>
                <p class="mb-4">Las redes de <strong>Memoria a Corto y Largo Plazo (Long Short-Term Memory)</strong> fueron diseñadas específicamente para solucionar el problema del gradiente desvanecido. Su innovación es la <strong>célula de memoria</strong>.</p>
                <div class="concept-box">
                    <h4 class="text-lg font-semibold mb-2 text-dark">La Célula de Memoria y las Compuertas</h4>
                    <p>Una célula LSTM es como una cinta transportadora (el <strong>estado de la célula</strong>) que corre a lo largo de toda la secuencia. La red puede leer, escribir y borrar información de esta cinta gracias a tres "compuertas" (gates), que son pequeñas redes neuronales que aprenden a abrirse y cerrarse para regular el flujo de información.</p>
                </div>

                <h3 class="text-2xl font-bold mt-8 mb-4">Animación Detallada de la Arquitectura de una Célula LSTM</h3>
                <p class="mb-4">La clave de la LSTM reside en su "célula de memoria" y sus tres "compuertas" (gates), que regulan el flujo de información. Estas compuertas son como pequeños interruptores que deciden qué información es importante recordar, cuál olvidar y cuál pasar al siguiente paso.</p>
                <div class="visualization">
                    <svg width="100%" height="auto" viewBox="0 0 800 450">
                        <style>.gate-label{font-family:Google Sans; font-weight:bold; text-anchor:middle; font-size: 16px;} .op-label{font-family:Roboto Mono; font-size:24px; text-anchor:middle;} .flow-arrow{stroke:#5f6368; stroke-width:1.5; marker-end:url(#arrow-flow);}</style>
                        <defs><marker id="arrow-flow" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse"><path d="M 0 0 L 10 5 L 0 10 z" fill="#5f6368"/></marker></defs>
                        <!-- Cell State -->
                        <path d="M 50 100 H 750" stroke="#202124" stroke-width="4" marker-end="url(#arrow-flow)" marker-start="url(#arrow-flow)"/>
                        <text x="400" y="80" class="gate-label">Estado de la Célula (Memoria a Largo Plazo)</text>
                        <!-- Forget Gate -->
                        <g transform="translate(150, 200)">
                            <rect x="-50" y="-30" width="100" height="60" rx="10" fill="#FCE8E6" stroke="#EA4335" stroke-width="2" id="forget-gate-rect"/>
                            <text y="5" class="gate-label" fill="#C5221F">Compuerta de Olvido (f)</text>
                            <circle cx="0" cy="80" r="15" fill="#FBBC04"><title>Función Sigmoide</title><text x="0" y="5" class="op-label" fill="white">σ</text></circle>
                            <path d="M 0 30 V 65" class="flow-arrow"/>
                            <circle cx="0" cy="-80" r="15" fill="#1A73E8"><title>Multiplicación</title><text x="0" y="8" class="op-label" fill="white">×</text></circle>
                            <path d="M 0 -65 V -100" class="flow-arrow" marker-start="url(#arrow-flow)"/>
                            <path d="M -80 -100 H 150" stroke="#202124" stroke-width="2"/>
                            <text x="0" y="110" class="state-label">Decide qué olvidar del estado anterior.</text>
                        </g>
                        <!-- Input Gate -->
                        <g transform="translate(400, 200)">
                            <rect x="-50" y="-30" width="100" height="60" rx="10" fill="#E8F0FE" stroke="#1A73E8" stroke-width="2" id="input-gate-rect"/>
                            <text y="5" class="gate-label" fill="#1A73E8">Compuerta de Entrada (i)</text>
                            <circle cx="-30" cy="80" r="15" fill="#FBBC04"><title>Función Sigmoide</title><text x="0" y="5" class="op-label" fill="white">σ</text></circle>
                            <circle cx="30" cy="80" r="15" fill="#FBBC04"><title>Función Tanh</title><text x="0" y="5" class="op-label" fill="white">tanh</text></circle>
                            <circle cx="0" cy="-80" r="15" fill="#34A853"><title>Suma</title><text x="0" y="8" class="op-label" fill="white">+</text></circle>
                            <path d="M 0 -65 V -100" class="flow-arrow" marker-start="url(#arrow-flow)"/>
                            <text x="0" y="110" class="state-label">Decide qué información nueva almacenar.</text>
                        </g>
                        <!-- Output Gate -->
                        <g transform="translate(650, 200)">
                            <rect x="-50" y="-30" width="100" height="60" rx="10" fill="#E6F4EA" stroke="#34A853" stroke-width="2" id="output-gate-rect"/>
                            <text y="5" class="gate-label" fill="#1E8E3E">Compuerta de Salida (o)</text>
                            <circle cx="0" cy="80" r="15" fill="#FBBC04"><title>Función Sigmoide</title><text x="0" y="5" class="op-label" fill="white">σ</text></circle>
                            <path d="M 0 30 V 65" class="flow-arrow"/>
                            <circle cx="0" cy="-80" r="15" fill="#1A73E8"><title>Multiplicación</title><text x="0" y="8" class="op-label" fill="white">×</text></circle>
                            <path d="M 0 -65 V -100" class="flow-arrow" marker-start="url(#arrow-flow)"/>
                            <path d="M 0 -100 H 750" stroke="#202124" stroke-width="2"/>
                            <text x="0" y="110" class="state-label">Decide qué parte del estado oculto será la salida.</text>
                        </g>
                        <text x="400" y="420" text-anchor="middle" class="gate-label">h(t) - Estado Oculto (Memoria a Corto Plazo)</text>

                        <!-- Animation -->
                        <animate
                            attributeName="fill"
                            values="#FCE8E6; #EA4335; #FCE8E6"
                            keyTimes="0; 0.5; 1"
                            dur="3s"
                            repeatCount="indefinite"
                            targetElement="forget-gate-rect"
                        />
                        <animate
                            attributeName="fill"
                            values="#E8F0FE; #1A73E8; #E8F0FE"
                            keyTimes="0; 0.5; 1"
                            dur="3s"
                            repeatCount="indefinite"
                            targetElement="input-gate-rect"
                        />
                        <animate
                            attributeName="fill"
                            values="#E6F4EA; #34A853; #E6F4EA"
                            keyTimes="0; 0.5; 1"
                            dur="3s"
                            repeatCount="indefinite"
                            targetElement="output-gate-rect"
                        />
                    </svg>
                </div>
                <h3 class="text-2xl font-bold mt-12 mb-4">La Matemática de las Compuertas</h3>
                <div class="grid md:grid-cols-2 gap-4">
                    <div class="formula-box">Olvido: f(t) = σ(Wf * [h(t-1), x(t)] + bf)</div>
                    <div class="formula-box">Entrada: i(t) = σ(Wi * [h(t-1), x(t)] + bi)</div>
                    <div class="formula-box">Salida: o(t) = σ(Wo * [h(t-1), x(t)] + bo)</div>
                    <div class="formula-box">Candidato: g(t) = tanh(Wg * [h(t-1), x(t)] + bg)</div>
                </div>
                <div class="visualization mt-8">
                    <h4 class="text-xl font-bold text-center mb-4">Comparativa Visual: RNN vs. GRU vs. LSTM</h4>
                    <div class="grid md:grid-cols-3 gap-4">
                        <div class="p-4 border rounded-lg text-center">
                            <h5 class="font-bold mb-2">RNN</h5>
                            <svg width="100%" height="auto" viewBox="0 0 100 100"><rect x="10" y="10" width="80" height="80" rx="5" fill="#F1F3F4"/><text x="50" y="55" class="label">tanh</text></svg>
                        </div>
                        <div class="p-4 border rounded-lg text-center">
                            <h5 class="font-bold mb-2">GRU</h5>
                            <svg width="100%" height="auto" viewBox="0 0 100 100"><rect x="10" y="10" width="80" height="80" rx="5" fill="#E6F4EA"/><text x="50" y="45" class="label">σ</text><text x="50" y="75" class="label">tanh</text></svg>
                        </div>
                        <div class="p-4 border rounded-lg text-center">
                            <h5 class="font-bold mb-2">LSTM</h5>
                            <svg width="100%" height="auto" viewBox="0 0 100 100"><rect x="10" y="10" width="80" height="80" rx="5" fill="#E8F0FE"/><text x="50" y="35" class="label">σ</text><text x="50" y="65" class="label">σ</text><text x="50" y="95" class="label">tanh</text></svg>
                        </div>
                    </div>
                    <p class="text-center text-sm mt-2">Una representación simplificada de la complejidad interna de cada celda.</p>
                </div>

                <div class="visualization mt-8">
                    <h4 class="text-xl font-bold text-center mb-4">Conectograma de una Red Neuronal Recurrente</h4>
                    <p class="text-center text-sm mb-4">Este conectograma muestra cómo las neuronas de una RNN están interconectadas a través del tiempo.</p>
                    <div id="connectogram-rnn"></div>
                    <script>
                        // Datos de ejemplo para el conectograma
                        const nodes = [
                            { id: "h_t-1", group: 0 },
                            { id: "x_t", group: 1 },
                            { id: "h_t", group: 0 },
                            { id: "y_t", group: 2 }
                        ];
                        const links = [
                            { source: "h_t-1", target: "h_t", value: 1 },
                            { source: "x_t", target: "h_t", value: 1 },
                            { source: "h_t", target: "y_t", value: 1 }
                        ];

                        let connectogramHtml = '<svg width="100%" height="200" viewBox="0 0 400 200">';
                        connectogramHtml += '<g transform="translate(50,50)">';

                        // Dibuja los nodos
                        nodes.forEach((node, i) => {
                            connectogramHtml += `<circle cx="${i * 100}" cy="75" r="20" fill="${['#FBBC04', '#34A853', '#EA4335'][node.group]}" />`;
                            connectogramHtml += `<text x="${i * 100}" y="80" text-anchor="middle" fill="white">${node.id}</text>`;
                        });

                        // Dibuja los enlaces
                        links.forEach(link => {
                            const sourceNode = nodes.find(n => n.id === link.source);
                            const targetNode = nodes.find(n => n.id === link.target);
                            const sourceIndex = nodes.indexOf(sourceNode);
                            const targetIndex = nodes.indexOf(targetNode);
                            connectogramHtml += `<line x1="${sourceIndex * 100}" y1="75" x2="${targetIndex * 100}" y2="75" stroke="#5f6368" stroke-width="2" />`;
                        });

                        connectogramHtml += '</g></svg>';
                        document.getElementById('connectogram-rnn').innerHTML = connectogramHtml;
                    </script>
                </div>
            </section>

<!-- Section 3.5: Esquemas Avanzados LSTM -->
<section class="content-section">
    <h2 class="text-3xl font-bold mb-6">3.5 Esquemas Avanzados de LSTM</h2>
    <p class="mb-4">Para visualizar en profundidad el flujo interno de una LSTM, esta sección presenta cinco diagramas animados que ilustran su comportamiento.</p>

    <div class="visualization mt-8">
        <h4 class="text-xl font-bold text-center mb-4">Flujo de Información a través de la Célula</h4>
        <svg width="100%" height="220" viewBox="0 0 800 220">
            <defs>
                <marker id="arrow" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse">
                    <path d="M0 0 L10 5 L0 10 z" fill="#5f6368" />
                </marker>
            </defs>
            <path d="M50 110 H750" stroke="#202124" stroke-width="4" marker-end="url(#arrow)" marker-start="url(#arrow)" />
            <rect id="gate1" x="150" y="70" width="80" height="80" rx="10" fill="#FCE8E6" stroke="#EA4335" stroke-width="2" />
            <rect id="gate2" x="360" y="70" width="80" height="80" rx="10" fill="#E8F0FE" stroke="#1A73E8" stroke-width="2" />
            <rect id="gate3" x="570" y="70" width="80" height="80" rx="10" fill="#E6F4EA" stroke="#34A853" stroke-width="2" />
            <text x="190" y="65" text-anchor="middle" font-family="Google Sans" font-weight="bold">Olvido</text>
            <text x="400" y="65" text-anchor="middle" font-family="Google Sans" font-weight="bold">Entrada</text>
            <text x="610" y="65" text-anchor="middle" font-family="Google Sans" font-weight="bold">Salida</text>
            <circle cx="50" cy="110" r="10" fill="#FBBC04">
                <animate attributeName="cx" values="50;190;400;610;750" dur="5s" repeatCount="indefinite" />
            </circle>
        </svg>
    </div>

    <div class="visualization mt-8">
        <h4 class="text-xl font-bold text-center mb-4">Compuertas Pulsantes</h4>
        <svg width="100%" height="140" viewBox="0 0 600 140">
            <rect id="fGate" x="80" y="20" width="120" height="100" rx="10" fill="#FCE8E6" stroke="#EA4335" stroke-width="2" />
            <rect id="iGate" x="240" y="20" width="120" height="100" rx="10" fill="#E8F0FE" stroke="#1A73E8" stroke-width="2" />
            <rect id="oGate" x="400" y="20" width="120" height="100" rx="10" fill="#E6F4EA" stroke="#34A853" stroke-width="2" />
            <animate xlink:href="#fGate" attributeName="opacity" values="0.3;1;0.3" dur="3s" repeatCount="indefinite" />
            <animate xlink:href="#iGate" attributeName="opacity" values="0.3;1;0.3" dur="3s" begin="1s" repeatCount="indefinite" />
            <animate xlink:href="#oGate" attributeName="opacity" values="0.3;1;0.3" dur="3s" begin="2s" repeatCount="indefinite" />
            <text x="140" y="75" text-anchor="middle" font-family="Google Sans" font-weight="bold">f(t)</text>
            <text x="300" y="75" text-anchor="middle" font-family="Google Sans" font-weight="bold">i(t)</text>
            <text x="460" y="75" text-anchor="middle" font-family="Google Sans" font-weight="bold">o(t)</text>
        </svg>
    </div>

    <div class="visualization mt-8">
        <h4 class="text-xl font-bold text-center mb-4">Ciclo LSTM Bidireccional</h4>
        <svg width="100%" height="160" viewBox="0 0 700 160">
            <defs>
                <marker id="arrow2" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse">
                    <path d="M0 0 L10 5 L0 10 z" fill="#5f6368" />
                </marker>
            </defs>
            <path d="M100 80 H600" stroke="#1A73E8" stroke-width="2" marker-end="url(#arrow2)" />
            <path d="M600 110 H100" stroke="#34A853" stroke-width="2" marker-end="url(#arrow2)" />
            <circle cx="100" cy="80" r="10" fill="#1A73E8">
                <animate attributeName="cx" values="100;600" dur="4s" repeatCount="indefinite" />
            </circle>
            <circle cx="600" cy="110" r="10" fill="#34A853">
                <animate attributeName="cx" values="600;100" dur="4s" repeatCount="indefinite" />
            </circle>
            <text x="350" y="50" text-anchor="middle" font-family="Google Sans" font-weight="bold">Forward</text>
            <text x="350" y="140" text-anchor="middle" font-family="Google Sans" font-weight="bold">Backward</text>
        </svg>
    </div>

    <div class="visualization mt-8">
        <h4 class="text-xl font-bold text-center mb-4">Estados de Memoria a lo Largo del Tiempo</h4>
        <svg width="100%" height="200" viewBox="0 0 700 200">
            <g id="bars" fill="#1A73E8">
                <rect x="50" y="50" width="40" height="120" />
                <rect x="140" y="80" width="40" height="90" />
                <rect x="230" y="40" width="40" height="130" />
                <rect x="320" y="70" width="40" height="100" />
                <rect x="410" y="60" width="40" height="110" />
                <rect x="500" y="90" width="40" height="80" />
                <rect x="590" y="50" width="40" height="120" />
            </g>
            <animate xlink:href="#bars" attributeName="fill" values="#1A73E8;#EA4335;#1A73E8" dur="6s" repeatCount="indefinite" />
        </svg>
    </div>

    <div class="visualization mt-8">
        <h4 class="text-xl font-bold text-center mb-4">Flujo de Entrenamiento BPTT</h4>
        <svg width="100%" height="220" viewBox="0 0 700 220">
            <defs>
                <marker id="arrow3" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse">
                    <path d="M0 0 L10 5 L0 10 z" fill="#5f6368" />
                </marker>
            </defs>
            <g>
                <rect x="50" y="40" width="80" height="60" rx="8" fill="#F1F3F4" />
                <rect x="170" y="40" width="80" height="60" rx="8" fill="#F1F3F4" />
                <rect x="290" y="40" width="80" height="60" rx="8" fill="#F1F3F4" />
                <rect x="410" y="40" width="80" height="60" rx="8" fill="#F1F3F4" />
                <rect x="530" y="40" width="80" height="60" rx="8" fill="#F1F3F4" />
            </g>
            <path id="grad" d="M90 100 L90 160 L570 160" stroke="#EA4335" stroke-width="2" marker-end="url(#arrow3)" />
            <animate xlink:href="#grad" attributeName="stroke-width" values="2;8;2" dur="5s" repeatCount="indefinite" />
            <text x="340" y="190" text-anchor="middle" font-family="Google Sans" font-weight="bold">Backpropagation Through Time</text>
        </svg>
    </div>
</section>
<section class="content-section">
    <h2 class="text-3xl font-bold mb-6">6.8 Caso de Negocio: Detección de Fraude Textual</h2>
    <p class="mb-4">Las aseguradoras pueden analizar descripciones de incidentes y detectar patrones sospechosos utilizando LSTMs.</p>
    <div class="visualization">
        <h4 class="text-xl font-bold text-center mb-4">Esquema de Análisis</h4>
        <svg width="100%" height="120" viewBox="0 0 600 120">
            <style>.blk{fill:#F3E8FD;stroke:#9333EA;} .lbl{font-family:'Google Sans';font-size:12px;text-anchor:middle;} .arr{stroke:#9333EA;stroke-width:2;marker-end:url(#f-arr);}</style>
            <defs><marker id="f-arr" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse"><path d="M0 0L10 5L0 10z" fill="#9333EA"/></marker></defs>
            <g><rect x="40" y="40" width="120" height="40" rx="6" class="blk"/><text x="100" y="65" class="lbl">Texto</text></g>
            <path d="M160 60H270" class="arr"/>
            <g><rect x="270" y="40" width="120" height="40" rx="6" class="blk"/><text x="330" y="65" class="lbl">LSTM</text></g>
            <path d="M390 60H500" class="arr"/>
            <g><rect x="500" y="40" width="80" height="40" rx="6" class="blk"/><text x="540" y="65" class="lbl">Alerta</text></g>
        </svg>
    </div>
    <div class="visualization mt-8">
        <h4 class="text-xl font-bold text-center mb-4">Diagrama Detallado</h4>
        <svg width="100%" height="160" viewBox="0 0 600 160">
            <style>.bcase{fill:#F1F3F4;stroke:#5f6368;} .bcarr{stroke:#1A73E8;stroke-width:2;marker-end:url(#bcar);}</style>
            <defs><marker id="bcar" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse"><path d="M0 0L10 5L0 10z" fill="#1A73E8"/></marker></defs>
            <rect x="40" y="60" width="100" height="40" rx="8" class="bcase"/>
            <text x="90" y="85" text-anchor="middle">Entrada</text>
            <path d="M140 80H240" class="bcarr"/>
            <rect x="240" y="60" width="100" height="40" rx="8" class="bcase"/>
            <text x="290" y="85" text-anchor="middle">Proceso</text>
            <path d="M340 80H440" class="bcarr"/>
            <rect x="440" y="60" width="100" height="40" rx="8" class="bcase"/>
            <text x="490" y="85" text-anchor="middle">Resultado</text>
        </svg>
        <p class="text-center text-sm mt-2">Flujo detallado que complementa el esquema previo.</p>
    </div>
</section>
<section class="content-section">
    <h2 class="text-3xl font-bold mb-6">6.5 Caso de Negocio: Monitoreo de Noticias</h2>
    <p class="mb-4">Una agencia de medios aplica RNNs para rastrear menciones de marca y detectar tendencias en artículos de prensa.</p>
    <div class="visualization">
        <h4 class="text-xl font-bold text-center mb-4">Esquema de Flujos de Noticias</h4>
        <svg width="100%" height="150" viewBox="0 0 600 150">
            <style>.box{fill:#FEF7E0;stroke:#F29900;} .arrow{stroke:#5f6368;stroke-width:2;marker-end:url(#narr);}</style>
            <defs><marker id="narr" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse"><path d="M0 0L10 5L0 10z" fill="#5f6368"/></marker></defs>
            <rect x="50" y="55" width="120" height="40" rx="8" class="box"/>
            <text x="110" y="80" text-anchor="middle">Noticias</text>
            <path d="M170 75H290" class="arrow"/>
            <rect x="290" y="35" width="120" height="40" rx="8" class="box"/>
            <text x="350" y="60" text-anchor="middle">Tokenización</text>
            <path d="M350 75V115" class="arrow"/>
            <rect x="290" y="115" width="120" height="40" rx="8" class="box"/>
            <text x="350" y="140" text-anchor="middle">RNN</text>
            <path d="M410 75H530" class="arrow"/>
            <rect x="530" y="55" width="120" height="40" rx="8" class="box"/>
            <text x="590" y="80" text-anchor="middle">Tendencias</text>
        </svg>
        <p class="text-center text-sm mt-2">El análisis continuo permite anticipar temas emergentes.</p>
    </div>
    <div class="visualization mt-8">
        <h4 class="text-xl font-bold text-center mb-4">Diagrama Detallado</h4>
        <svg width="100%" height="160" viewBox="0 0 600 160">
            <style>.bcase{fill:#F1F3F4;stroke:#5f6368;} .bcarr{stroke:#1A73E8;stroke-width:2;marker-end:url(#bcar);}</style>
            <defs><marker id="bcar" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse"><path d="M0 0L10 5L0 10z" fill="#1A73E8"/></marker></defs>
            <rect x="40" y="60" width="100" height="40" rx="8" class="bcase"/>
            <text x="90" y="85" text-anchor="middle">Entrada</text>
            <path d="M140 80H240" class="bcarr"/>
            <rect x="240" y="60" width="100" height="40" rx="8" class="bcase"/>
            <text x="290" y="85" text-anchor="middle">Proceso</text>
            <path d="M340 80H440" class="bcarr"/>
            <rect x="440" y="60" width="100" height="40" rx="8" class="bcase"/>
            <text x="490" y="85" text-anchor="middle">Resultado</text>
        </svg>
        <p class="text-center text-sm mt-2">Flujo detallado que complementa el esquema previo.</p>
    </div>
    <div class="visualization mt-8">
        <h4 class="text-xl font-bold text-center mb-4">Mapa Resumido de Gates</h4>
        <svg width="100%" height="120" viewBox="0 0 600 120">
            <style>.gbox{fill:#F1F3F4;stroke:#5f6368;} .garr{stroke:#5f6368;stroke-width:2;marker-end:url(#bcar);} .gtext{font-family:'Google Sans';font-size:14px;text-anchor:middle;}</style>
            <rect x="40" y="40" width="120" height="40" rx="8" class="gbox"/>
            <text x="100" y="65" class="gtext">Entrada</text>
            <path d="M160 60H260" class="garr"/>
            <rect x="260" y="40" width="120" height="40" rx="8" class="gbox"/>
            <text x="320" y="65" class="gtext">Olvido</text>
            <path d="M380 60H480" class="garr"/>
            <rect x="480" y="40" width="120" height="40" rx="8" class="gbox"/>
            <text x="540" y="65" class="gtext">Salida</text>
        </svg>
    </div>
</section>
<!-- End Section 3.5 -->
            <!-- Section 4: GRUs -->
            <section class="content-section">
                <h2 class="text-3xl font-bold mb-6">4. GRU: La Elegancia de la Simplicidad</h2>
                <p class="mb-4">La <strong>Unidad Recurrente Cerrada (Gated Recurrent Unit)</strong> es una variación más moderna de la LSTM. Ofrece un rendimiento similar pero con una arquitectura más simple, lo que la hace más rápida de entrenar.</p>
                <div class="visualization">
                    <h4 class="text-xl font-bold text-center mb-4">LSTM vs. GRU: Duelo de Arquitecturas</h4>
                    <div class="grid md:grid-cols-2 gap-8">
                        <div class="p-4 border-2 border-blue-500 rounded-lg">
                            <h3 class="text-center font-bold text-blue-600 mb-2">LSTM</h3>
                            <ul class="list-disc list-inside space-y-1">
                                <li>Estado de Célula (Largo Plazo)</li>
                                <li>Estado Oculto (Corto Plazo)</li>
                                <li class="font-semibold text-red-600">Compuerta de Olvido</li>
                                <li class="font-semibold text-blue-600">Compuerta de Entrada</li>
                                <li class="font-semibold text-green-600">Compuerta de Salida</li>
                            </ul>
                        </div>
                        <div class="p-4 border-2 border-green-500 rounded-lg">
                            <h3 class="text-center font-bold text-green-600 mb-2">GRU</h3>
                            <ul class="list-disc list-inside space-y-1">
                                <li>Solo Estado Oculto</li>
                                <li class="font-semibold text-purple-600">Compuerta de Actualización</li>
                                <li class="font-semibold text-orange-600">Compuerta de Reseteo</li>
                                <li><br></li>
                                <li><br></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section 4.1: Desvanecimiento del Gradiente -->
            <section class="content-section">
                <h2 class="text-3xl font-bold mb-6">4.1 Animación del Desvanecimiento del Gradiente</h2>
                <p class="mb-4">Uno de los grandes desafíos de las primeras RNN era que el gradiente se hacía cada vez más pequeño al retro-propagarse a través de los pasos de tiempo. Esta animación ilustra ese problema.</p>
                <div class="visualization">
                    <svg id="grad-vanish" width="100%" height="200" viewBox="0 0 800 200">
                        <style>.bar{fill:#1A73E8;} .axis{stroke:#5f6368;stroke-width:2;}</style>
                        <line x1="50" y1="170" x2="750" y2="170" class="axis" />
                        <line x1="50" y1="20" x2="50" y2="170" class="axis" />
                    </svg>
                    <script>
                        const svgVanish = document.getElementById('grad-vanish');
                        for(let i=0;i<10;i++){
                            const h = 140*Math.exp(-0.4*i);
                            const rect = document.createElementNS('http://www.w3.org/2000/svg','rect');
                            rect.setAttribute('x', 60+i*70);
                            rect.setAttribute('y', 170-h);
                            rect.setAttribute('width', 40);
                            rect.setAttribute('height', h);
                            rect.setAttribute('class','bar');
                            svgVanish.appendChild(rect);
                            rect.animate([
                                { transform: 'scaleY(0)', transformOrigin: 'bottom' },
                                { transform: 'scaleY(1)', transformOrigin: 'bottom' }
                            ], { duration: 1000, delay: i*300, fill: 'forwards' });
                        }
                    </script>
                    <p class="text-center text-sm mt-2">Cada barra representa el tamaño del gradiente en un paso de tiempo. Observa cómo se desvanece rápidamente.</p>
                </div>
            </section>

            <!-- Section 5: Advanced Architectures -->
            <section class="content-section">
                <h2 class="text-3xl font-bold mb-6">5. Arquitecturas Avanzadas</h2>
                <p class="mb-4">Podemos mejorar el poder de las RNNs básicas combinándolas en arquitecturas más complejas, como las redes bidireccionales y las redes apiladas.</p>

                <h3 class="text-2xl font-bold mt-8 mb-4">El Poder de la Bidireccionalidad</h3>
                <p>Una RNN estándar solo ve el pasado. Para entender una palabra, a menudo necesitamos ver también el futuro. Por ejemplo, en la frase "El oso se asustó con el oso de peluche", para entender el segundo "oso", necesitamos ver "de peluche". Una RNN bidireccional procesa la secuencia en ambas direcciones y combina los resultados.</p>
                <div class="visualization">
                    <h4 class="text-xl font-bold text-center mb-4">Animación de una Red Bidireccional</h4>
                    <svg width="100%" height="auto" viewBox="0 0 800 300">
                        <style>.label{font-family: 'Google Sans', sans-serif; font-weight: bold; text-anchor: middle;} .token{font-family: 'Roboto Mono', sans-serif; text-anchor: middle;}</style>
                        <!-- Tokens -->
                        <text x="100" y="50" class="token">"el"</text>
                        <text x="300" y="50" class="token">"oso"</text>
                        <text x="500" y="50" class="token">"pardo"</text>
                        <!-- Forward RNN -->
                        <path d="M 50 100 H 550" stroke="#1A73E8" stroke-width="2" marker-end="url(#arrow-flow)"/>
                        <circle cx="100" cy="100" r="15" fill="#1A73E8"><animate attributeName="cx" values="100; 300; 500" dur="6s" repeatCount="indefinite" /></circle>
                        <text x="600" y="105" class="label" fill="#1A73E8">Forward State</text>
                        <!-- Backward RNN -->
                        <path d="M 550 150 H 50" stroke="#34A853" stroke-width="2" marker-end="url(#arrow-flow)"/>
                        <circle cx="500" cy="150" r="15" fill="#34A853"><animate attributeName="cx" values="500; 300; 100" dur="6s" repeatCount="indefinite" /></circle>
                        <text x="600" y="155" class="label" fill="#34A853">Backward State</text>
                        <!-- Output -->
                        <g transform="translate(300, 250)">
                            <rect x="-100" y="-20" width="200" height="40" rx="10" fill="#FBBC04"/>
                            <text x="0" y="5" class="label">Output Combinado</text>
                        </g>
                        <path d="M 300 120 V 230" stroke="#FBBC04" stroke-width="2" marker-end="url(#arrow-flow)"/>
                        <path d="M 300 170 V 230" stroke="#FBBC04" stroke-width="2" marker-end="url(#arrow-flow)"/>
                    </svg>
                </div>

                <div class="visualization mt-8">
                    <h4 class="text-xl font-bold text-center mb-4">Diagrama de Flujo: RNN Bidireccional</h4>
                    <p class="text-center text-sm mb-4">Este diagrama de flujo muestra cómo una RNN bidireccional procesa una secuencia en ambas direcciones y combina los resultados.</p>
                    <svg width="100%" height="auto" viewBox="0 0 800 300">
                        <style>.label{font-family: 'Google Sans', sans-serif; font-weight: bold; text-anchor: middle;} .token{font-family: 'Roboto Mono', sans-serif; text-anchor: middle;}</style>
                        <defs><marker id="arrow-flow" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse"><path d="M 0 0 L 10 5 L 0 10 z" fill="#5f6368"/></marker></defs>
                        <!-- Input -->
                        <g>
                            <rect x="350" y="20" width="100" height="50" rx="5" fill="#F1F3F4"/><text x="400" y="50" class="token">Input</text>
                        </g>
                        <!-- Forward RNN -->
                        <g>
                            <rect x="150" y="100" width="150" height="80" rx="10" fill="#E8F0FE"/><text x="225" y="140" class="label">Forward RNN</text>
                        </g>
                        <!-- Backward RNN -->
                        <g>
                            <rect x="500" y="100" width="150" height="80" rx="10" fill="#E6F4EA"/><text x="575" y="140" class="label">Backward RNN</text>
                        </g>
                        <!-- Output -->
                        <g>
                            <rect x="350" y="200" width="100" height="50" rx="5" fill="#FEF7E0"/><text x="400" y="230" class="label">Output</text>
                        </g>
                        <!-- Arrows -->
                        <path d="M 400 70 L 225 100" stroke="#5f6368" stroke-width="2" marker-end="url(#arrow-flow)"/>
                        <path d="M 400 70 L 575 100" stroke="#5f6368" stroke-width="2" marker-end="url(#arrow-flow)"/>
                        <path d="M 225 180 L 400 200" stroke="#5f6368" stroke-width="2" marker-end="url(#arrow-flow)"/>
                        <path d="M 575 180 L 400 200" stroke="#5f6368" stroke-width="2" marker-end="url(#arrow-flow)"/>
                    </svg>
                </div>

                <h3 class="text-2xl font-bold mt-12 mb-4">Redes Apiladas (Stacked RNNs)</h3>
                <p>Al igual que en las redes convolucionales, apilar capas de RNNs permite al modelo aprender representaciones más complejas y abstractas de los datos. La salida de una capa se convierte en la entrada de la siguiente.</p>

                <div class="visualization mt-8">
                    <h4 class="text-xl font-bold text-center mb-4">Arquitectura de una Red Apilada</h4>
                    <p class="text-center text-sm mb-4">Este diagrama muestra cómo se apilan múltiples capas de RNNs para procesar una secuencia.</p>
                    <svg width="100%" height="auto" viewBox="0 0 800 400">
                        <style>.label{font-family: 'Google Sans', sans-serif; font-weight: bold; text-anchor: middle;} .token{font-family: 'Roboto Mono', sans-serif; text-anchor: middle;}</style>
                        <defs><marker id="arrow-flow" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse"><path d="M 0 0 L 10 5 L 0 10 z" fill="#5f6368"/></marker></defs>
                        <!-- Input Layer -->
                        <g>
                            <rect x="50" y="300" width="100" height="50" rx="5" fill="#F1F3F4"/><text x="100" y="330" class="token">Input</text>
                        </g>
                        <!-- RNN Layer 1 -->
                        <g>
                            <rect x="250" y="250" width="100" height="50" rx="5" fill="#E8F0FE"/><text x="300" y="280" class="label">RNN Capa 1</text>
                        </g>
                        <!-- RNN Layer 2 -->
                        <g>
                            <rect x="450" y="150" width="100" height="50" rx="5" fill="#E6F4EA"/><text x="500" y="180" class="label">RNN Capa 2</text>
                        </g>
                        <!-- Output Layer -->
                        <g>
                            <rect x="650" y="50" width="100" height="50" rx="5" fill="#FEF7E0"/><text x="700" y="80" class="label">Output</text>
                        </g>
                        <!-- Arrows -->
                        <path d="M 150 325 L 250 275" stroke="#5f6368" stroke-width="2" marker-end="url(#arrow-flow)"/>
                        <path d="M 350 275 L 450 175" stroke="#5f6368" stroke-width="2" marker-end="url(#arrow-flow)"/>
                        <path d="M 550 175 L 650 75" stroke="#5f6368" stroke-width="2" marker-end="url(#arrow-flow)"/>
                    </svg>
                </div>
            </section>

            <!-- Section 6: Business Case -->
            <section class="content-section">
                <h2 class="text-3xl font-bold mb-6">6. Caso Práctico: Clasificador de Reviews con LSTM</h2>
                <p class="mb-4">Vamos a aplicar lo aprendido a un problema de negocio real: clasificar la opinión de los clientes sobre un producto en positiva o negativa. Usaremos una LSTM Bidireccional.</p>
                <div class="concept-box">
                    <h4 class="text-lg font-semibold mb-2 text-dark">Cómo Funciona un Clasificador de Reviews con LSTM</h4>
                    <p class="mb-2">Imagina que una empresa de comercio electrónico quiere clasificar automáticamente las opiniones de sus clientes sobre productos como "positivas" o "negativas". Un modelo basado en LSTM bidireccional es ideal para esta tarea.</p>
                    <ul class="list-disc list-inside ml-4 space-y-1">
                        <li><strong>Entrada:</strong> Cada review de cliente se convierte en una secuencia de números (embeddings de palabras), que el modelo puede entender.</li>
                        <li><strong>Procesamiento Bidireccional:</strong> La LSTM lee la review tanto de principio a fin como de fin a principio. Esto le permite capturar el contexto completo de la oración, entendiendo matices como la ironía o las negaciones ("no es bueno" vs. "es bueno").</li>
                        <li><strong>Salida:</strong> El modelo produce una probabilidad de que la review sea positiva. Si la probabilidad es alta, se clasifica como positiva; si es baja, como negativa.</li>
                    </ul>
                    <p class="mt-2"><strong>Impacto en el Negocio:</strong> Esto permite a la empresa monitorear el sentimiento del cliente en tiempo real, identificar rápidamente problemas con productos o servicios, y responder de manera proactiva. Por ejemplo, si muchas reviews negativas mencionan un problema específico, la empresa puede lanzar una actualización o un comunicado para abordarlo, mejorando la satisfacción del cliente y protegiendo la reputación de la marca.</p>
                </div>

                <h3 class="text-2xl font-bold mt-12 mb-4">6.1 Detección de Anomalías en Series Temporales con LSTMs</h3>
                <p class="mb-4">Las LSTMs no solo son excelentes para el lenguaje; también son muy potentes para analizar cualquier tipo de datos secuenciales, como los datos de sensores, transacciones financieras o registros de servidores, para detectar patrones inusuales que podrían indicar un problema o un fraude.</p>
                <div class="concept-box">
                    <h4 class="text-lg font-semibold mb-2 text-dark">Caso de Uso: Monitoreo de Servidores</h4>
                    <p class="mb-2">Una empresa de tecnología necesita monitorear el rendimiento de sus servidores para detectar fallos antes de que afecten a los usuarios. Los datos de rendimiento (uso de CPU, memoria, tráfico de red) son series temporales.</p>
                    <ul class="list-disc list-inside ml-4 space-y-1">
                        <li><strong>Entrenamiento:</strong> Una LSTM se entrena con datos históricos de rendimiento normal del servidor. Aprende a predecir el siguiente valor en la serie temporal basándose en los valores anteriores.</li>
                        <li><strong>Detección:</strong> En tiempo real, la LSTM predice el siguiente valor de rendimiento. Si el valor real se desvía significativamente de la predicción del modelo, se marca como una anomalía.</li>
                    </ul>
                    <p class="mt-2"><strong>Impacto en el Negocio:</strong> Permite la detección temprana de problemas en la infraestructura, evitando caídas del servicio, optimizando el uso de recursos y reduciendo los costos operativos. Por ejemplo, un pico inusual en el tráfico de red podría indicar un ataque DDoS o un fallo en una aplicación, permitiendo al equipo de operaciones actuar antes de que el problema escale.</p>
                </div>

                <h3 class="text-2xl font-bold mt-12 mb-4">6.2 Generación de Texto con RNNs: Autocompletado y Chatbots Simples</h3>
                <p class="mb-4">Aunque las RNNs simples tienen limitaciones para dependencias a largo plazo, son sorprendentemente efectivas para tareas de generación de texto más cortas o donde el contexto inmediato es suficiente. Son la base de muchas funciones de autocompletado y chatbots de primera generación.</p>
                <div class="concept-box">
                    <h4 class="text-lg font-semibold mb-2 text-dark">Caso de Uso: Autocompletado de Búsquedas</h4>
                    <p class="mb-2">Imagina un motor de búsqueda que sugiere consultas a medida que el usuario escribe. Una RNN puede ser entrenada para predecir la siguiente palabra basándose en las palabras ya escritas.</p>
                    <ul class="list-disc list-inside ml-4 space-y-1">
                        <li><strong>Entrenamiento:</strong> La RNN se entrena con un vasto corpus de consultas de búsqueda. Aprende las secuencias de palabras más comunes.</li>
                        <li><strong>Generación:</strong> Cuando el usuario escribe "mejores restaurantes en", la RNN, basándose en su "memoria" de secuencias, puede sugerir "mejores restaurantes en Madrid", "mejores restaurantes en Barcelona", etc.</li>
                    </ul>
                    <p class="mt-2"><strong>Impacto en el Negocio:</strong> Mejora la experiencia del usuario al acelerar las búsquedas, reduce la frustración por errores tipográficos y guía a los usuarios hacia consultas más relevantes, lo que puede aumentar la tasa de clics y la satisfacción general.</p>
                </div>

                <h3 class="text-2xl font-bold mt-12 mb-4">6.3 Modelado de Temas: Descubriendo los Asuntos Ocultos</h3>
                <p class="mb-4">Imagina tener miles de documentos (artículos de noticias, emails de clientes) y no saber de qué hablan. El modelado de temas es una técnica no supervisada que descubre automáticamente los "temas" abstractos que ocurren en una colección de documentos.</p>
                <div class="concept-box">
                    <h4 class="text-lg font-semibold mb-2 text-dark">Caso de Uso: Análisis de Feedback de Empleados</h4>
                    <p class="mb-2">Una gran corporación realiza una encuesta anual de satisfacción. En lugar de leer miles de respuestas abiertas, pueden usar modelado de temas para agruparlas automáticamente en categorías como "Compensación y Beneficios", "Cultura de Trabajo", "Oportunidades de Carrera" y "Preocupaciones sobre Management".</p>
                    <ul class="list-disc list-inside ml-4 space-y-1">
                        <li><strong>Técnica Clásica (LDA):</strong> El Análisis Discriminante Latente (LDA) es el algoritmo clásico. Funciona bajo la premisa de que cada documento es una mezcla de temas, y cada tema es una mezcla de palabras. Es un modelo estadístico poderoso, pero no captura el contexto secuencial.</li>
                        <li><strong>Enfoque con RNN/LSTM:</strong> Los modelos secuenciales pueden mejorar el modelado de temas al considerar el orden de las palabras. Una LSTM puede ser entrenada para predecir la siguiente palabra en un documento, y su estado oculto final puede ser utilizado como una representación rica del contenido del documento. Agrupando (clustering) estos estados ocultos, podemos descubrir temas coherentes de una manera que respeta la semántica y la estructura del texto.</li>
                    </ul>
                    <p class="mt-2"><strong>Impacto en el Negocio:</strong> Permite a la dirección obtener una visión clara y cuantitativa de las principales preocupaciones de los empleados, identificar áreas de mejora y tomar decisiones estratégicas basadas en datos para mejorar el ambiente laboral y la retención de talento.</p>
                </div>
                <div class="visualization">
                    <h4 class="text-xl font-bold text-center mb-4">Visualizando Temas Descubiertos</h4>
                    <p class="text-center text-sm mb-4">El modelo agrupa documentos y extrae las palabras clave que definen cada tema.</p>
                    <div class="grid md:grid-cols-3 gap-4 text-center">

                        <div class="p-4 bg-blue-100 rounded-lg border border-blue-200">

                            <h5 class="font-bold mb-2">Tema 1: Tecnología</h5>

                            <p class="font-mono text-sm">servidor, datos, red, sistema, cpu, memoria, error</p>

                        </div>

                        <div class="p-4 bg-green-100 rounded-lg border border-green-200">

                            <h5 class="font-bold mb-2">Tema 2: Negocios</h5>

                            <p class="font-mono text-sm">cliente, producto, venta, mercado, precio, empresa, equipo</p>

                        </div>

                        <div class="p-4 bg-yellow-100 rounded-lg border border-yellow-200">

                            <h5 class="font-bold mb-2">Tema 3: Soporte</h5>

                            <p class="font-mono text-sm">ticket, problema, ayuda, usuario, solución, gracias, agente</p>

                        </div>

                    </div>
                </div>

                <h3 class="text-2xl font-bold mt-12 mb-4">6.4 Reconocimiento de Entidades Nombradas (NER) con LSTMs</h3>
                <p class="mb-4">El NER es una tarea de clasificación a nivel de palabra. El objetivo es identificar y categorizar entidades clave en el texto. A diferencia de un clasificador de texto simple, que asigna una etiqueta a todo el documento, un modelo NER asigna una etiqueta a cada palabra (o token).</p>
                <div class="concept-box">
                    <h4 class="text-lg font-semibold mb-2 text-dark">¿Por qué las LSTMs Bidireccionales son Perfectas para NER?</h4>
                    <p class="mb-2">NER es un problema de etiquetado de secuencias por excelencia. Para decidir si "Washington" es una persona o un lugar, necesitas contexto de ambos lados.</p>
                    <ul class="list-disc list-inside ml-4 space-y-1">
                        <li>En "<strong>Washington</strong> fue el primer presidente", la palabra "presidente" a la derecha es clave.</li>
                        <li>En "Viajé a <strong>Washington</strong> D.C.", las letras "D.C." a la derecha son la pista.</li>
                    </ul>
                    <p class="mt-2">Una BiLSTM procesa la oración en ambas direcciones, dándole al modelo la información contextual completa para cada palabra antes de tomar una decisión de etiquetado. La salida en cada paso de tiempo no es una única clasificación, sino una etiqueta para la palabra en esa posición.</p>
                </div>
                <div class="visualization">

                    <h4 class="text-xl font-bold text-center mb-4">Etiquetado de Secuencia NER con BiLSTM</h4>

                    <p class="text-center text-sm mb-4">El modelo asigna una etiqueta a cada token (formato IOB: Inside, Outside, Beginning).</p>

                    <div class="p-4 bg-gray-50 rounded-md text-lg text-center">

                        <span class="inline-block text-center m-1"><span class="block">Juan</span><span class="block text-xs font-bold text-green-600 bg-green-100 px-2 py-1 rounded">B-PER</span></span>

                        <span class="inline-block text-center m-1"><span class="block">Pérez</span><span class="block text-xs font-bold text-green-600 bg-green-100 px-2 py-1 rounded">I-PER</span></span>

                        <span class="inline-block text-center m-1"><span class="block">de</span><span class="block text-xs font-bold text-gray-500 bg-gray-200 px-2 py-1 rounded">O</span></span>

                        <span class="inline-block text-center m-1"><span class="block">Google</span><span class="block text-xs font-bold text-blue-600 bg-blue-100 px-2 py-1 rounded">B-ORG</span></span>

                        <span class="inline-block text-center m-1"><span class="block">viajará</span><span class="block text-xs font-bold text-gray-500 bg-gray-200 px-2 py-1 rounded">O</span></span>

                        <span class="inline-block text-center m-1"><span class="block">a</span><span class="block text-xs font-bold text-gray-500 bg-gray-200 px-2 py-1 rounded">O</span></span>

                        <span class="inline-block text-center m-1"><span class="block">Nueva</span><span class="block text-xs font-bold text-red-600 bg-red-100 px-2 py-1 rounded">B-LOC</span></span>

                        <span class="inline-block text-center m-1"><span class="block">York</span><span class="block text-xs font-bold text-red-600 bg-red-100 px-2 py-1 rounded">I-LOC</span></span>

                        <span class="inline-block text-center m-1"><span class="block">.</span><span class="block text-xs font-bold text-gray-500 bg-gray-200 px-2 py-1 rounded">O</span></span>

                    </div>

                </div>
            </section>

            <!-- Section 7: Summary -->
            <section class="content-section">
                <h2 class="text-3xl font-bold mb-6">Resumen del Códice II: El Amanecer de la Memoria en la IA</h2>
<section class="content-section">
    <h2 class="text-3xl font-bold mb-6">6.4 Backpropagation Ilustrado</h2>
    <p class="mb-4">Para entrenar las redes recurrentes, el error debe viajar hacia atrás en el tiempo. Esta animación muestra la idea general del algoritmo de retropropagación.</p>
    <div class="visualization">
        <h4 class="text-xl font-bold text-center mb-4">Flujo del Gradiente</h4>
        <svg width="100%" height="240" viewBox="0 0 700 240">
            <style>.cell{fill:#F1F3F4;stroke:#DADCE0;} .arrow{stroke:#EA4335;stroke-width:2;} .label{font-family:Google Sans;font-weight:bold;text-anchor:middle;}</style>
            <defs><marker id="arrow-grad" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse"><path d="M0 0L10 5L0 10z" fill="#EA4335"/></marker></defs>
            <g id="t1"><rect x="50" y="100" width="80" height="60" rx="5" class="cell"/><text x="90" y="135" class="label">t-2</text></g>
            <g id="t2"><rect x="210" y="100" width="80" height="60" rx="5" class="cell"/><text x="250" y="135" class="label">t-1</text></g>
            <g id="t3"><rect x="370" y="100" width="80" height="60" rx="5" class="cell"/><text x="410" y="135" class="label">t</text></g>
            <g id="t4"><rect x="530" y="100" width="80" height="60" rx="5" class="cell"/><text x="570" y="135" class="label">t+1</text></g>
            <path class="arrow" d="M90 100V70" marker-end="url(#arrow-grad)">
                <animate attributeName="d" values="M90 100V70;M250 100V70;M410 100V70;M570 100V70" dur="6s" repeatCount="indefinite"/>
            </path>
        </svg>
    </div>
</section>
<section class="content-section">
    <h2 class="text-3xl font-bold mb-6">6.5 Diagramas de Flujo de Secuencias</h2>
    <p class="mb-4">Explora paso a paso cómo una RNN procesa una secuencia mediante un esquema animado y colorido.</p>
    <div class="visualization">
        <div class="w-full max-w-md bg-gray-100 p-4 rounded-lg border border-gray-200">
            <label for="seq-input" class="block text-sm font-medium text-gray-700 mb-2">Secuencia (números separados por espacio):</label>
            <input type="text" id="seq-input" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2" value="1 0 1 1 0">
            <button id="run-seq" class="mt-4 bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded w-full">Ejecutar</button>
            <div id="seq-log" class="mt-4 p-3 bg-white rounded-md border border-gray-200 font-mono text-sm h-32 overflow-y-auto"></div>
        </div>
        <script>
            function runSequence() {
                const input = document.getElementById('seq-input').value.trim().split(/\s+/);
<section class="content-section">
    <h2 class="text-3xl font-bold mb-6">6.7 Lecturas Recomendadas</h2>
    <p class="mb-4">Si quieres profundizar en el entrenamiento de redes recurrentes y comprender sus matices, revisa los siguientes textos y tutoriales en línea:</p>
    <ul class="list-disc list-inside ml-4 space-y-1">
        <li>"Understanding LSTM Networks" por Chris Olah, un clásico para visualizar cada compuerta con ejemplos claros.</li>
        <li>"The Unreasonable Effectiveness of Recurrent Neural Networks" de Andrej Karpathy, que muestra ejemplos sorprendentes de generación de texto.</li>
        <li>Tutoriales de TensorFlow y PyTorch que implementan desde cero una RNN para predicción de caracteres.</li>
        <li>Publicaciones recientes sobre variaciones como QRNN y SRU, que buscan combinar eficiencia y precisión.</li>
        <li>Experimentos académicos que comparan el rendimiento de RNNs, GRUs y LSTMs en diferentes lenguas y dominios.</li>
    </ul>
    <p class="mt-4">Estos recursos complementan la teoría con prácticas y discusiones más avanzadas. Explóralos con calma para consolidar tus conocimientos.</p>
     <div class="visualization mt-8">
        <h4 class="text-xl font-bold text-center mb-4">Etapas de Entrenamiento de una RNN</h4>
        <svg width="100%" height="150" viewBox="0 0 700 150">
            <style>.phase{font-family:Google Sans;font-weight:bold;text-anchor:middle;}</style>
            <defs><marker id="arrow-flow" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse"><path d="M0 0L10 5L0 10z" fill="#5f6368"/></marker></defs>
            <g>
                <rect x="20" y="60" width="160" height="40" rx="10" fill="#E8F0FE"/>
                <text x="100" y="85" class="phase">Datos</text>
            </g>
            <path d="M180 80H260" stroke="#5f6368" stroke-width="2" marker-end="url(#arrow-flow)"/>
            <g>
                <rect x="260" y="60" width="160" height="40" rx="10" fill="#E6F4EA"/>
                <text x="340" y="85" class="phase">Entrenamiento</text>
            </g>
            <path d="M420 80H500" stroke="#5f6368" stroke-width="2" marker-end="url(#arrow-flow)"/>
            <g>
                <rect x="500" y="60" width="160" height="40" rx="10" fill="#FEF7E0"/>
                <text x="580" y="85" class="phase">Modelo</text>
            </g>
        </svg>
    </div>
</section>
                let state = 0;
                let log = '';
                input.forEach((v, i) => {
                    const num = parseInt(v) || 0;
                    state = (state * 0.7 + num) % 1;
                    log += `Paso ${i+1}: entrada=${num} estado=${state.toFixed(2)}\n`;
                });
                document.getElementById('seq-log').innerText = log;
            }
            document.getElementById('run-seq').addEventListener('click', runSequence);
            document.addEventListener('DOMContentLoaded', runSequence);
        </script>
    <div class="visualization mt-4">
        <h4 class="text-xl font-bold text-center mb-2">Secuencia Ejemplo</h4>
        <svg width="100%" height="120" viewBox="0 0 600 120">
            <style>.cell{fill:#E8F0FE;stroke:#1A73E8;} .arrow{stroke:#5f6368;stroke-width:2;marker-end:url(#arrow-seq);} .label{font-family:Google Sans;font-weight:bold;text-anchor:middle;}</style>
            <defs><marker id="arrow-seq" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="6" markerHeight="6" orient="auto"><path d="M0 0L10 5L0 10z" fill="#5f6368"/></marker></defs>
            <g><rect x="40" y="40" width="60" height="40" rx="6" class="cell"/><text x="70" y="65" class="label">1</text></g>
            <path d="M100 60H160" class="arrow"/>
            <g><rect x="160" y="40" width="60" height="40" rx="6" class="cell"/><text x="190" y="65" class="label">0.7</text></g>
            <path d="M220 60H280" class="arrow"/>
            <g><rect x="280" y="40" width="60" height="40" rx="6" class="cell"/><text x="310" y="65" class="label">1.0</text></g>
            <path d="M340 60H400" class="arrow"/>
            <g><rect x="400" y="40" width="60" height="40" rx="6" class="cell"/><text x="430" y="65" class="label">1.0</text></g>
        </svg>
    </div>
    </div>
    <div class="visualization mt-8">
        <h4 class="text-xl font-bold text-center mb-4">Ejemplo de Estados</h4>
        <table class="w-full text-sm text-center border-collapse">
            <thead><tr><th class="border p-2">Paso</th><th class="border p-2">Entrada</th><th class="border p-2">Estado</th></tr></thead>
            <tbody>
                <tr><td class="border p-2">1</td><td class="border p-2">1</td><td class="border p-2">0.0</td></tr>
                <tr><td class="border p-2">2</td><td class="border p-2">0</td><td class="border p-2">0.0</td></tr>
                <tr><td class="border p-2">3</td><td class="border p-2">1</td><td class="border p-2">0.0</td></tr>
                <tr><td class="border p-2">4</td><td class="border p-2">1</td><td class="border p-2">0.0</td></tr>
                <tr><td class="border p-2">5</td><td class="border p-2">0</td><td class="border p-2">0.0</td></tr>
            </tbody>
        </table>
    </div>
    <div class="business-case-box">
        <h4 class="text-lg font-semibold mb-2 text-dark">Caso de Negocio: Pronóstico de Demanda</h4>
    <div class="visualization">
        <h4 class="text-xl font-bold text-center mb-4">Evolución de Ventas</h4>
        <svg width="100%" height="200" viewBox="0 0 600 200">
            <style>.line{fill:none;stroke:#1A73E8;stroke-width:2;} .pred{fill:none;stroke:#EA4335;stroke-width:2;} .axis{stroke:#5f6368;stroke-width:1;} .grid{stroke:#e8eaed;stroke-width:1;stroke-dasharray:2;}</style>
            <g class="grid-lines"><line x1="50" y1="160" x2="550" y2="160" class="grid"/><line x1="50" y1="120" x2="550" y2="120" class="grid"/><line x1="50" y1="80" x2="550" y2="80" class="grid"/></g>
            <polyline points="50,150 150,110 250,90 350,80 450,100 550,130" class="line"/>
            <polyline points="50,160 150,130 250,100 350,90 450,110 550,140" class="pred"/>
            <line x1="50" y1="170" x2="550" y2="170" class="axis"/><rect x="420" y="40" width="12" height="12" fill="#1A73E8"/><text x="440" y="50" font-size="10">Real</text><rect x="420" y="60" width="12" height="12" fill="#EA4335"/><text x="440" y="70" font-size="10">Predicción</text>
        </svg>
        <p class="text-center text-sm mt-2">La línea azul refleja ventas reales mientras que la roja muestra la predicción generada por la RNN.</p>
    </div>
    <div class="visualization mt-8">
        <h4 class="text-xl font-bold text-center mb-4">Diagrama Detallado</h4>
        <svg width="100%" height="160" viewBox="0 0 600 160">
            <style>.bcase{fill:#F1F3F4;stroke:#5f6368;} .bcarr{stroke:#1A73E8;stroke-width:2;marker-end:url(#bcar);}</style>
            <defs><marker id="bcar" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse"><path d="M0 0L10 5L0 10z" fill="#1A73E8"/></marker></defs>
            <rect x="40" y="60" width="100" height="40" rx="8" class="bcase"/>
            <text x="90" y="85" text-anchor="middle">Entrada</text>
            <path d="M140 80H240" class="bcarr"/>
            <rect x="240" y="60" width="100" height="40" rx="8" class="bcase"/>
            <text x="290" y="85" text-anchor="middle">Proceso</text>
            <path d="M340 80H440" class="bcarr"/>
            <rect x="440" y="60" width="100" height="40" rx="8" class="bcase"/>
            <text x="490" y="85" text-anchor="middle">Resultado</text>
        </svg>
        <p class="text-center text-sm mt-2">Flujo detallado que complementa el esquema previo.</p>
    </div>
        <p>Una cadena minorista entrena una RNN para predecir ventas semanales, integrando calendarios de promoción y estacionalidad. El diagrama superior muestra el flujo de datos.</p>
    </div>
</section>
<section class="content-section">
    <h2 class="text-3xl font-bold mb-6">6.6 Recordatorio Visual</h2>
    <p class="mb-4">Las redes secuenciales siguen siendo esenciales para comprender la evolución histórica del PLN. Observa esta línea de tiempo expandida con hitos clave.</p>
    <div class="visualization">
        <svg width="100%" height="180" viewBox="0 0 700 180">
            <style>.event{font-family:Roboto;font-size:12px;text-anchor:middle;} .year{font-family:Google Sans;font-weight:bold;text-anchor:middle;}</style>
            <line x1="50" y1="90" x2="650" y2="90" stroke="#5f6368" stroke-width="2"/>
            <circle cx="100" cy="90" r="6" fill="#1A73E8"/>
            <text x="100" y="70" class="year">1997</text>
            <text x="100" y="110" class="event">LSTM</text>
            <circle cx="250" cy="90" r="6" fill="#1A73E8"/>
            <text x="250" y="70" class="year">2003</text>
            <text x="250" y="110" class="event">GRU</text>
            <circle cx="400" cy="90" r="6" fill="#1A73E8"/>
            <text x="400" y="70" class="year">2013</text>
            <text x="400" y="110" class="event">Word2Vec</text>
            <circle cx="550" cy="90" r="6" fill="#1A73E8"/>
            <text x="550" y="70" class="year">2017</text>
            <text x="550" y="110" class="event">Transformer</text>
        </svg>
    </div>
</section>
                <p class="mb-4">En este códice, hemos desentrañado el fascinante mundo de los modelos secuenciales, comprendiendo cómo las máquinas pasaron de tratar el texto como una "bolsa de palabras" a entender el orden y el contexto, un paso crucial hacia una verdadera comprensión del lenguaje.</p>
                <div class="concept-box">
                    <h4 class="text-lg font-semibold mb-2 text-dark">Conceptos Clave Dominados:</h4>
                    <ul class="list-disc list-inside ml-4 space-y-2">
                        <li>La <strong>necesidad imperante de la memoria</strong> para entender el orden y el contexto, superando las limitaciones de los modelos que ignoran el orden.</li>
                        <li>La arquitectura fundamental de las <strong>Redes Neuronales Recurrentes (RNN)</strong>, su mecanismo de bucle y el concepto de estado oculto como "memoria" de la secuencia.</li>
                        <li>El <strong>problema del gradiente desvanecido</strong>, la principal limitación de las RNNs simples para aprender dependencias a largo plazo.</li>
                        <li>La solución elegante y revolucionaria: las <strong>arquitecturas con compuertas (gated)</strong> como <strong>LSTM</strong> y <strong>GRU</strong>. Hemos explorado cómo sus compuertas de olvido, entrada y salida permiten un control preciso sobre el flujo de información, resolviendo el problema del gradiente.</li>
                        <li>El poder de las <strong>arquitecturas avanzadas</strong> como las redes bidireccionales (que leen la secuencia en ambos sentidos) y las redes apiladas (que aprenden representaciones jerárquicas).</li>
                        <li>Las <strong>aplicaciones prácticas</strong> de estos modelos en el mundo real, desde el análisis de sentimiento hasta la detección de anomalías en series temporales.</li>
                    </ul>
                </div>
                <div class="visualization mt-8">
                    <h4 class="text-xl font-bold text-center mb-4">LSTM vs GRU</h4>
                    <svg width="100%" height="160" viewBox="0 0 800 160">
                        <style>.cell{font-family:'Google Sans';font-weight:bold;text-anchor:middle;}</style>
                        <rect x="100" y="40" width="250" height="80" fill="#E8F0FE" stroke="#1A73E8"/>
                        <text x="225" y="75" class="cell">LSTM: 3 Compuertas</text>
                        <rect x="450" y="40" width="250" height="80" fill="#E6F4EA" stroke="#34A853"/>
                        <text x="575" y="75" class="cell">GRU: 2 Compuertas</text>
                        <path d="M350 80H450" stroke="#5f6368" marker-end="url(#arrow-flow)"/>
                    </svg>
                    <p class="text-center text-sm mt-2">Ambas controlan el flujo de información, pero la GRU simplifica la arquitectura.</p>
                </div>
                <h3 class="text-2xl font-bold mt-8 mb-4">El Camino Hacia Adelante: La Próxima Gran Revolución</h3>
                <p>Has dominado los pilares del PLN secuencial. Sin embargo, incluso las LSTMs más potentes tienen un cuello de botella inherente: deben procesar la información palabra por palabra. Este procesamiento secuencial es lento y dificulta la captura eficiente de relaciones entre palabras muy distantes en secuencias extremadamente largas.</p>
                <p class="mt-4">¿Y si pudiéramos procesar todas las palabras a la vez, permitiendo que cada palabra "mirara" a todas las demás para entender su contexto, sin importar la distancia? Esta pregunta nos lleva directamente a la arquitectura que define la era moderna de la IA, una arquitectura que ha transformado por completo el panorama del PLN y más allá.</p>
                <p class="mt-6 text-center text-xl font-bold text-blue-500">Prepárate para el Códice III: La Revolución Transformer.</p>
            </section>

<section class="content-section">
    <h2 class="text-3xl font-bold mb-6">2.7 Flujo de Entrenamiento de una RNN</h2>
    <p class="mb-4">Este esquema resume las fases para entrenar modelos recurrentes tradicionales.</p>
    <div class="visualization">
        <svg width="100%" height="180" viewBox="0 0 800 180">
            <style>.step{font-family:'Google Sans';font-weight:bold;text-anchor:middle;} .line{stroke:#5f6368;stroke-width:2;marker-end:url(#arrow-end);} .desc{font-family:Roboto Mono;font-size:12px;text-anchor:middle;}</style>
            <defs><marker id="arrow-end" viewBox="0 0 10 10" refX="10" refY="5" markerWidth="6" markerHeight="6" orient="auto"><path d="M0 0L10 5L0 10z" fill="#5f6368"/></marker></defs>
            <g><rect x="50" y="60" width="120" height="40" rx="8" fill="#E8F0FE"/><text x="110" y="85" class="step">Datos</text></g>
            <line x1="170" y1="80" x2="280" y2="80" class="line"/>
            <g><rect x="280" y="60" width="120" height="40" rx="8" fill="#E6F4EA"/><text x="340" y="85" class="step">RNN</text></g>
            <line x1="400" y1="80" x2="510" y2="80" class="line"/>
            <g><rect x="510" y="60" width="120" height="40" rx="8" fill="#FEF7E0"/><text x="570" y="85" class="step">Loss</text></g>
            <line x1="630" y1="80" x2="740" y2="80" class="line"/>
            <g><rect x="740" y="60" width="120" height="40" rx="8" fill="#FCE8E6"/><text x="800" y="85" class="step">Optimizador</text></g>
        </svg>
    </div>
</section>
        </div>
    </main>

    <section class="content-section">
        <h2 class="text-3xl font-bold mb-6">Diagrama de Familias Secuenciales</h2>
        <div class="visualization">
            <svg width="100%" height="100" viewBox="0 0 620 100">
                <style>.box{fill:#F1F3F4;stroke:#5f6368;} .arrow{stroke:#5f6368;stroke-width:2;marker-end:url(#ar);}</style>
                <defs><marker id="ar" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="6" markerHeight="6" orient="auto"><path d="M0 0L10 5L0 10z" fill="#5f6368"/></marker></defs>
                <g><rect x="10" y="30" width="80" height="40" rx="6" class="box"/><text x="50" y="55" text-anchor="middle">N-gram</text></g>
                <path d="M90 50H170" class="arrow"/>
                <g><rect x="170" y="30" width="80" height="40" rx="6" class="box"/><text x="210" y="55" text-anchor="middle">HMM</text></g>
                <path d="M250 50H330" class="arrow"/>
                <g><rect x="330" y="30" width="80" height="40" rx="6" class="box"/><text x="370" y="55" text-anchor="middle">RNN</text></g>
                <path d="M410 50H490" class="arrow"/>
                <g><rect x="490" y="30" width="80" height="40" rx="6" class="box"/><text x="530" y="55" text-anchor="middle">LSTM</text></g>
            </svg>
        </div>
    </section>

    <section class="content-section">
        <h2 class="text-3xl font-bold mb-6">Referencias Clave</h2>
        <ul class="list-disc list-inside ml-4 space-y-1">
            <li>Hochreiter &amp; Schmidhuber 1997 - Long Short-Term Memory</li>
            <li>Mikolov et al. 2010 - RNN Language Models</li>
            <li>Ouyang et al. 2022 - InstructGPT</li>
        </ul>
    </section>

    <section class="content-section">
        <h2 class="text-3xl font-bold mb-6">Glosario Rápido</h2>
        <table class="min-w-full text-sm text-left border-collapse">
            <thead><tr><th class="border px-2 py-1">Sigla</th><th class="border px-2 py-1">Significado</th></tr></thead>
            <tbody>
                <tr><td class="border px-2 py-1">RNN</td><td class="border px-2 py-1">Red Neuronal Recurrente</td></tr>
                <tr><td class="border px-2 py-1">LSTM</td><td class="border px-2 py-1">Long Short-Term Memory</td></tr>
                <tr><td class="border px-2 py-1">GRU</td><td class="border px-2 py-1">Gated Recurrent Unit</td></tr>
            </tbody>
        </table>
    </section>

    <footer class="bg-gray-50 text-center py-6 text-gray-500 text-sm border-t border-gray-200 mt-12">
        <p>Pharu Analytics 2025</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const sections = document.querySelectorAll('.content-section');
            const observer = new IntersectionObserver(entries => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.style.opacity = 1;
                        entry.target.style.transform = 'translateY(0)';
                        observer.unobserve(entry.target);
                    }
                });
            }, { threshold: 0.1 });
            sections.forEach(section => {
                observer.observe(section);
            });
        });
    </script>

</body>
</html>
